#! /usr/bin/env sh

SCRIPT_DIR="$(dirname $0)"
INSTALL_DIR="$SCRIPT_DIR/../"

# init id_rsa
ID_RSA_LOCATION="$INSTALL_DIR/var/id_rsa"
[[ ! -f "$ID_RSA_LOCATION" ]] && printf "generating rsa key ......" && ssh-keygen -q -t rsa -b 4096 -N "" -f "$ID_RSA_LOCATION" && printf "done.\n" && \
echo "Please ADD the following public key to SSH Server, then RESTART the client service" && ssh-keygen -y -f "$ID_RSA_LOCATION"

# init rules
RULES_LOCATION="$INSTALL_DIR/var/rules"
[[ ! -f "$RULES_LOCATION" ]] && cp "$INSTALL_DIR/etc/rules.example" "$INSTALL_DIR/var/rules" && echo "Please ADD some rules to $INSTALL_DIR/var/rules, then RESTART the client service"

touch "$INSTALL_DIR/var/.inited"
